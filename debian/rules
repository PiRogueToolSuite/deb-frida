#! /usr/bin/make -f

# We only target arm64 and armhf; thankfully both frida and dpkg
# agree on their name:
FRIDA_ARCH := $(shell dpkg --print-architecture)
PYTHON     := python-linux-$(FRIDA_ARCH)
TOOLS      := tools-linux-$(FRIDA_ARCH)
DIR        := build/frida_thin-linux-$(FRIDA_ARCH)

export PYBUILD_NAME=frida
%:
	dh $@ --with python3 --buildsystem=none

override_dh_auto_build:
	$(MAKE) $(PYTHON)
	$(MAKE) $(TOOLS)

override_dh_auto_install:
	mkdir -p debian/tmp/usr
	cp -r $(DIR)/* debian/tmp/usr
